# Lab 7 Midterm Review

[Lab09 - CS61A of UCB(2021-Fall) - MartinLwx's Blog](https://martinlwx.github.io/zh-cn/lab09-cs61a-of-ucb/)

## Recursion and Tree Recursion

### Q1: Subsequences

```shell
python ok -q subseqs --local
```

ä»æ•´ä½“ä¸Šçœ‹ï¼Œæ˜¯æƒ³å®Œæˆä»ä¸€ä¸ªå®Œæ•´åˆ—è¡¨æ‹†åˆ†å‡ºæ‰€æœ‰ä¸å®Œæ•´çš„å­åˆ—è¡¨çš„ï¼Œä¸é™é¡ºåºï¼Œä»é€’å½’æ€è€ƒã€‚

å¦‚æœç”¨é€’å½’çš„è¯ï¼Œä¸è®ºå¦‚ä½•å®ç°ï¼Œæœ€åä¼šæœ‰é‡å¤å­åˆ—è¡¨çš„æƒ…å†µï¼Œæ¢ä¸ªæ–¹æ³•ç”¨å¾ªç¯å§ã€‚

```
[]
[1] 
[1,2] [1,3] [1,2,3]
[2] [2,3] 
[3]
```

æ‹†åˆ†ä¸ºä¸¤æ­¥å®ç°ï¼š

1. åœ¨æ‰€æœ‰å­åˆ—è¡¨çš„å›ºå®šä½ç½®æ’å…¥å…ƒç´ 
2. é€†å‘åº”ç”¨ï¼Œé€æ­¥æŠŠå…ƒç´ æ·»åŠ åˆ°å­åˆ—è¡¨ä¸­

ä¸çŸ¥é“ï¼Œæƒ³äº†åŠå¤©æ²¡æƒ³å‡ºæ¥...

çœ‹äº†ç­”æ¡ˆç»“æœè¿˜æ˜¯é€’å½’ï¼Œæˆ‘çš„æ€è€ƒè¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼ˆå¯èƒ½ä¹Ÿæ˜¯æœ‰æ®µæ—¶é—´æ²¡ç¢°ç„¶åæ¡èµ·æ¥

å‡è®¾å¾…å¤„ç†çš„å…ƒç´ åºåˆ— = ç¬¬ä¸€ä¸ªæ–°å…ƒç´  + å·²ç»æ‰¾åˆ°æ‰€æœ‰å¯èƒ½å­åºåˆ—çš„æ—§åºåˆ—ï¼Œ

é—®é¢˜æ¼”å˜ä¸ºï¼šå¦‚ä½•åŒ…å«ç¬¬ä¸€ä¸ªæ–°å…ƒç´ çš„å­åºåˆ—	è§£å†³æ–¹æ³• => æŠŠæ–°å…ƒç´ æ·»åŠ åˆ°æ¯ä¸ªå­åºåˆ—ï¼Œå’Œæ—§çš„å­åºåˆ—æ‹¼è£…èµ·æ¥

*********************

çŸ¥é“é—®é¢˜åœ¨å“ªäº†ï¼Œè¿™ä¸ªé€’å½’æ˜¯åå‘åˆ—è¡¨å®Œæˆçš„ï¼Œä¸ä¼šå‡ºç°é‡å¤çš„æƒ…å†µï¼Œè€Œæˆ‘æ€è€ƒçš„æ˜¯æ­£å‘çš„ï¼ˆå€’ä¸å¦‚è¯´æ ¹æœ¬æ²¡æœ‰æ·±å…¥æ€è€ƒé€’å½’çš„æƒ…å†µ

```
[] [3]
[2] [2,3]
[1] [1,2] [1,2,3] [1,3]
```

```python
def insert_into_all(item, nested_list):
	return [[item] + sub_list for sub_list in nested_list]
def subseqs(s):
    if len(s) <= 1:
        # å®šä¹‰é€’å½’å‡ºå£ ç»™å‡ºèµ·å§‹å…ƒç´  [] ä¸ºåé¢çš„å­ä¸²å¢é•¿ & ç©ºä¸²æƒ…å†µ
        return [[], s] if s != [] else [[]]
    else:
        temp = subseqs(s[1:])
        return insert_into_all(s[0], temp) + temp
```

çœŸçš„ä¸å®¹æ˜“æƒ³åˆ°... é€†å‘æ€è€ƒå¾ˆå®¹æ˜“æ­»è§’å•Šà²¥_à²¥	ç®—æ˜¯é»˜ä¸‹æ¥äº†.. æˆ‘ä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨



### Q2: Increasing Subsequences

```shell
python ok -q inc_subseqs --local
```

æœ‰ç‚¹éš¾å•Š... ä»€ä¹ˆç©æ„ï¼Œè¿™æœŸä¸­è€ƒè¯•éš¾åº¦é«˜æˆè¿™ä¸ªæ ·å­

ç”Ÿæˆçš„å­ä¸²ä¸­ï¼Œæ‰¾åˆ°ä¸¥æ ¼éé™åºçš„ä½ç½®è¿ç»­å…ƒç´ ç»„æˆçš„å­ä¸²	å‘ƒ... æˆ‘æƒ³æƒ³ï¼Œæƒ³ä¸å‡ºæ¥ç®—äº†

**********

å¯¹ï¼Œæˆ‘åˆå»çœ‹äº†ç­”æ¡ˆï¼Œæ€è·¯æ¯”è¾ƒç›¸åï¼Œä¸Šä¸€é¢˜çš„ä¾‹å­æ˜¯å‘å‰æ‹¼æ¥ï¼Œè¿™ä¸€é¢˜æ˜¯å‘åï¼Ÿ

è¿˜æ˜¯é€’å½’ï¼šæŠŠåˆ—è¡¨ S æ‹†åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œ`S[0]` å’Œå‡è®¾å·²ç»æ˜¯æ— é™åºçš„å­åºåˆ—ï¼Œå‘å‰æ‹¼æ¥

*******

é«˜ä¼°æˆ‘è‡ªå·±äº†ï¼Œä¸æ‡‚ï¼Œæ€è€ƒè¿‡ç¨‹åœ¨ä¸‹é¢

```python
def insert_into_all(item, nested_list):
    return [[item] + sub_list for sub_list in nested_list]

def inc_subseqs(s):
    def subseq_helper(s, prev):
        """
        å­å‡½æ•°æœ‰ 3 ä¸ªå‡ºå£
        1. ç©ºä¸²è¿”å›
        2. éé€’å¢ï¼šå¾ˆå·§å¦™ï¼Œå› ä¸ºé»˜è®¤å­ä¸²æ˜¯ç¬¦åˆè¦æ±‚çš„ï¼Œæ‰€ä»¥åªèƒ½å¾€åæ‰¾å­ä¸²
        3. æˆ‘.. æƒ³ä¸æ˜ç™½    æ™ºåŠ›å·®è·å§å¯èƒ½  b æ˜¯ a çš„ä¸€ç§å‰ç½®çŠ¶æ€   ç¡®å®š b ä¹‹åæ ¹æ® b å»å¾€å‰æ‰¾ a 
        ä½†æ˜¯ä¸ºä»€ä¹ˆ a çš„æ‰§è¡Œé¡ºåºåœ¨ b ä¹‹å‰å‘¢

        å…¶å® a å°±æ˜¯è´Ÿè´£é€’å½’åˆ°æœ€åä¸¤ä¸ªå…ƒç´ çš„ å®é™…æ˜¯ b åœ¨è¿›è¡Œæœ‰æ•ˆæ¯”è¾ƒ
        é‚£æ ·å°±è¿˜æœ‰ä¸ªé—®é¢˜ åœ¨æœ€å insert_into_all ç”¨çš„æ˜¯ s[0] è€Œä¸æ˜¯ prev

        åˆå»çœ‹äº†åŸä½œè€…çš„æ³¨é‡Šï¼Œæ›´çœ‹ä¸æ‡‚äº†ï¼Œä¹    a-include_s[0]  b-exclude_s[0]
        å¦‚æœä»…ä»æ˜¯å¦åŒ…å« s[0] æ¥çœ‹ é‚£ prev ä¸ä¼šå’Œ s[0] é‡å¤å—

        åœ¨ b çš„æƒ…å†µé‡Œ prev æ˜¯ä¸€ç›´ä¼ é€’ä¸‹å»çš„ ä¿æŒä¸å˜ ç»“åˆäºŒå·å‡ºå£ï¼Œè®¤ä¸º b ç›®çš„æ˜¯æ‰¾åˆ°æ‰€æœ‰ä»¥ prev å¼€å¤´çš„ç¬¦åˆè¦æ±‚çš„å­åºåˆ—
        è€Œ a çš„ç›®çš„å°±æ˜¯å¯¹æ‰€è°“é»˜è®¤ç¬¦åˆçš„å­åºåˆ—çš„å‘åçš„æŸ¥æ‰¾ æ›´æ–° b è¿ç®—çš„ prev
        """
        if not s:
            # ç©ºä¸²çš„æƒ…å†µç›´æ¥è¿”å›
            return [[]]
        elif s[0] < prev:
            return subseq_helper(s[1:], prev)
        else:
            # ä»å·¦åˆ°å³ é’ˆå¯¹æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¿›è¡Œä¸€æ¬¡éé™åºçš„éå†
            a = subseq_helper(s[1:], s[0])  # é€’å½’å…¥å£
            b = subseq_helper(s[1:], prev)  # ç¬¬ä¸€è½®é€’å½’ä¹‹å prev: 1 è¿”å› a æ‰§è¡Œçš„å‡½æ•°å¸§ å¥½ç²¾å¦™... 
            return insert_into_all(s[0], a) + b
    # prev åˆå§‹åŒ–ä¸º 0 çš„ç›®çš„æ˜¯åˆ¤æ–­æ˜¯å¦æ•´ä¸ªåºåˆ—ç¬¦åˆéé™åºçš„çŠ¶æ€
    return subseq_helper(s, 0)

    
seqs = inc_subseqs([1, 3, 2])
print(seqs)                 # [[1, 3], [1, 2], [1], [3], [2], []]
print(sorted(seqs))         # [[], [1], [1, 2], [1, 3], [2], [3]]
```

ä¸æ˜ç™½ï¼Œä¸æ‡‚ï¼Œä½ æ€äº†æˆ‘ä¹Ÿæ²¡æˆ



## Mutable Lists

### Q3: Trade

```shell
python ok -q trade --local
```

æ‰¾ä¸¤ä¸ªåˆ—è¡¨çš„æœ€çŸ­çš„ç›¸åŒçš„å‰ç¼€å’Œï¼Œç„¶åäº¤æ¢è¯¥å‰ç¼€ï¼ˆä¸¤ä¸ªå‰ç¼€çš„é•¿åº¦å¯ä»¥ä¸åŒ

æœ€ç¬¨çš„æ–¹æ³•ï¼šä¸ºæ¯ä¸ªåˆ—è¡¨è®¡ç®—æ‰€æœ‰çš„å‰ç¼€å’Œï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæœ‰ç›¸åŒçš„ï¼Œäº¤æ¢

å¿«æ…¢æŒ‡é’ˆï¼šè®©æ›´å°çš„æŒ‡é’ˆå¾€å‰èµ°ï¼Œå¦‚æœåè¶…äº†ï¼Œåœä¸‹ï¼Œè®©å¦ä¸€ä¸ªæŒ‡é’ˆèµ°ï¼ˆæç¤ºçš„åº”è¯¥ä¹Ÿæ˜¯è¿™ä¸ªæ€è·¯

åšå¯¹å•¦~



### Q4: Reverse

```shell
python ok -q reverse --local
```

åè½¬åˆ—è¡¨



## Nonlocal

### Q5: Glookup

```shell
python ok -q make_glookup --local
```



## Recursion / Tree Recursion

### Q6: Number of Trees

```shell
python ok -q num_trees --local
```

æ ¹æ®å¶å­æ•°é‡å€’æ¨æ ‘çš„ç»“æ„	How many full binary trees have exactly n leaves

æ ¹æ®å¡ç‰¹å…°çš„æ•°å­¦åŸç†å»å†™ï¼ˆè‡³äºæ¨å¯¼ï¼Œå‘ƒ... ğŸ˜¢

[ã€Œç®—æ³•å…¥é—¨ç¬”è®°ã€å¡ç‰¹å…°æ•° - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/97619085) 

é€‚ç”¨äº n = 0 å¼€å§‹
$$
C_1 = 1,C_n = C_{n - 1}\frac{4n - 2}{n + 1}
$$
ä»ç¼–ç¨‹è§’åº¦çš„é€’å½’æ¥çœ‹ï¼ˆå¯¹ n çš„å¼€å§‹ä½ç½®æ²¡æœ‰è¦æ±‚ï¼‰ï¼š
$$
h(n) = h(0)*h(n -1) + h(1)*h(n-2) + \cdots + h(n - 1)*h(0)
$$

```python
def get_catalan(n):
    if n == 1 or n == 2:
        return 1
    else:
        catalan = 0
        for i in range(1, n):
            # è®¡ç®—çš„æ˜¯ h(i) * h(j)
            # åŠ æ³•æ˜¯åœ¨é€’å½’è¿”å›çš„æ—¶å€™æŠŠç»“æœç›¸åŠ 
            catalan += get_catalan(i) * get_catalan(n - i)
    return catalan
```



## Nonlocal

### Q7: Advanced Counter

```shell
python ok -q make_advanced_counter_maker --local
```



# Done!

è¿™èŠ‚ç»ƒä¹ çš„é€’å½’å¥½éš¾à²¥_à²¥... å…¶ä»–çš„å€’è¿˜å¥½
